%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% LaTeX-Rahmen fuer das Erstellen von Masterarbeiten
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% allgemeine Einstellungen
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[twoside,12pt,a4paper]{report}
%\usepackage{reportpage}
\usepackage{epsf}
\usepackage{graphics, graphicx}
\usepackage{latexsym}
\usepackage[margin=10pt,font=small,labelfont=bf]{caption}
\usepackage[utf8]{inputenc}
\usepackage[toc,page]{appendix}


% Own packages
\usepackage[colorinlistoftodos]{todonotes}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{amssymb}
\usepackage{tabularx}
\usepackage{url}
\usepackage{amsmath}
\usepackage[permil]{overpic}
\usepackage{multirow}
\usepackage{enumitem}
\usepackage{fancyhdr}
\usepackage{booktabs} 

\newcolumntype{Y}{>{\centering\arraybackslash}X}
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\hyphenation{Table}
\hyphenation{Figure}
\hyphenation{Section}
\hyphenation{Chapter}


\textwidth 14cm
\textheight 22cm
\topmargin 0.0cm
\evensidemargin 1cm
\oddsidemargin 1cm
%\footskip 2cm
\parskip0.5explus0.1exminus0.1ex

% Kann von Student auch nach pers\"onlichem Geschmack ver\"andert werden.
\pagestyle{headings}
\fancypagestyle{plain}{%
\fancyhf{} % clear all header and footer fields
\fancyhead{} % clear all header fields
\fancyfoot{} % clear all footer fields
\fancyhead[RO]{\thepage}
\fancyhead[LE]{\thepage}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
}

\sloppy

\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% hier steht die neue Titelseite 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
\begin{titlepage}
 \begin{center}
  {\LARGE Eberhard Karls Universit\"at T\"ubingen}\\
  {\large Mathematisch-Naturwissenschaftliche Fakult\"at \\
Wilhelm-Schickard-Institut f\"ur Informatik\\[3.7cm]}
  {\huge Master Thesis Computer Science\\[2cm]}
  {\Large\bf  Incorporating Social Learning into Multi-Agent Reinforcement Learning
to \\Lower Carbon Emissions in Energy Systems\\[1.5cm]}
 {\large Kristina Lietz}\\[0.5cm]
01.12.2023\\[2cm]
{\small\bf Reviewers}\\[0.5cm]
% \parbox{7cm}{\begin{center}{\large Dr. Nicole Ludwig}\\
%   (Machine Learning in Sustainable Energy Systems)\\
%  {\footnotesize Cluster of Excellence – Machine Learning for Science\\
%	University of Tübingen}\end{center}}\hfill\parbox{7cm}{\begin{center}
%  {\large Prof. Dr. Setareh Maghsudi}\\
%  (Decision Making)\\
%  {\footnotesize Department of Computer Science\\
%	University of Tübingen}\end{center}
% }
   \large Dr. Nicole Ludwig \\
   (Machine Learning in Sustainable Energy Systems)\\
  \footnotesize Cluster of Excellence – Machine Learning for Science\\
	University of Tübingen \vspace{0.9cm}\\
  \large Prof. Dr. Setareh Maghsudi\\
  (Decision Making)\\
  \footnotesize Department of Computer Science\\
	University of Tübingen
  \end{center}
\end{titlepage}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Titelr"uckseite: Bibliographische Angaben
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty}
\vspace*{\fill}
\begin{minipage}{11.2cm}
\textbf{Lietz, Kristina:}\\
\emph{Incorporating Social Learning into Multi-Agent Reinforcement Learning
to Lower Carbon Emissions in Energy Systems}\\ Master Thesis Computer Science\\
Eberhard Karls Universit\"at T\"ubingen\\
Thesis period: 01.06.2023~--~01.12.2023
\end{minipage}
\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pagenumbering{roman}
\setcounter{page}{1}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Seite I: Zusammenfassug, Danksagung
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section*{Abstract}
Reducing the consumption of fossil fuels is crucial for mitigating climate change, as it reduces greenhouse gas emissions. At the same time, renewable energy creates more uncertainty in the energy supply, challenging the traditional approach of consuming available energy immediately.
This thesis explores integrating social learning into multi-agent reinforcement learning to minimize fossil fuel consumption in building energy management. Reinforcement learning agents are trained to learn optimal charging and discharging strategies for the batteries of buildings.
We use the CityLearn framework, modified to suit our requirements and define four key performance indicators for evaluation. As a baseline, we train a non-social soft actor-critic agent, which we compare with four social learning methods. These methods include imitation learning for policy mimicry, SAC-DemoPol, which biases the policy toward demonstrator actions, SAC-DemoQ, which increases the Q-values of demonstrator actions, and the MARLISA algorithm for collaborative fossil energy saving. The results indicate that the SAC-DemoQ agents, trained with a pre-trained demonstrator, outperform the soft actor-critic baseline by approximately 1.5 \% in fossil energy savings. Using novel building data, the social agents save about 1 \% more fossil energy. The other social methods achieved minimal or no improvement. We suggest future evaluation using more diverse datasets and employing methods such as value shaping, clustering for optimal demonstrator selection, and fine-tuning the imitation learning rate to enhance the efficacy of the proposed strategy in reducing fossil fuel consumption in buildings.

\newpage
\section*{Zusammenfassung}
Die Verringerung des Verbrauchs fossiler Brennstoffe und die damit verbundene Reduzierung der Treibhausgasemissionen sind für die Eindämmung des Klimawandels von entscheidender Bedeutung. Gleichzeitig schaffen erneuerbare Energien mehr Unsicherheit in der Energieversorgung, was den traditionellen Ansatz des sofortigen Verbrauchs der verfügbaren Energie infrage stellt.
In dieser Arbeit wird die Integration von sozialem Lernen in Multi-Agenten Reinforcement Learning untersucht, um den Verbrauch fossiler Brennstoffe im Energiemanagement von Gebäuden zu minimieren. Reinforcement Learning-Agenten werden auf das Lernen optimaler Lade-und Entladestrategien von Gebäudebatterien trainiert.
Wir verwenden das CityLearn-Framework, das wir an unsere Anforderungen anpassen, und definieren vier Key Performance Indicators für die Performanzbewertung. Als Ausgangsbasis trainieren wir einen nicht-sozialen Soft Actor-Critic-Agenten, den wir mit vier sozialen Lernmethoden vergleichen. Zu diesen Methoden gehören das Nachahmungslernen für die Nachahmung der Policy eines Demonstrators, SAC-DemoPol, wobei die Policy in Richtung der Demonstrantenaktionen gelenkt wird, SAC-DemoQ, wobei die Q-Werte der Demonstrantenaktionen erhöht werden, und der MARLISA-Algorithmus für kollaboratives fossiles Energiesparen. Die Ergebnisse zeigen, dass die SAC-DemoQ-Agenten, die mit einem vortrainierten Demonstrator trainiert wurden, die unsozialen Soft Actor-Critic-Agenten bei der Einsparung fossiler Energie um etwa 1,5 \% übertreffen. Bei Verwendung neuer Gebäudedaten sparen die sozialen Agenten etwa 1 \% mehr fossile Energie. Die anderen sozialen Ansätze zeigen keine oder nur minimale Verbesserung. Wir schlagen vor, zukünftige Evaluierungen mit vielfältigeren Datensätzen und unter Verwendung von Methoden wie Value Shaping, Clustering für die optimale Auswahl von Demonstratoren und Feinabstimmung der Imitationslernrate durchzuführen, um die Wirksamkeit der entwickelten Strategie bei der Reduzierung des Verbrauchs fossiler Brennstoffe in Gebäuden zu verbessern.



\newpage
\section*{Acknowledgements}
I sincerely thank everyone who has supported me during my studies and in this work.

First, I would like to express my gratitude to my closest family: My sister Annika, my parents Heike, Rüdiger, Andrea and my grandma Ellen. Your emotional support and encouragement helped me overcome all the difficult times, particularly outside of my studies and motivated me to persevere. Your belief in me and my abilities was always encouraging.

I am also infinitely grateful to my friends who have supported me, especially in the last few months: Jule, Elli, Basti, Steffen, Fabio and Flop. To Basti: Without you, I would have finished my Master's degree much earlier :P. Your support, friendship and the fact that you are always there for me were crucial for this work. The proofreading by some of you also helped me a lot. The moments we have shared and the moral support you have given me are precious and have given me balance and a sense of belonging.

I would especially like to thank my supervisor, Dr. Nicole Ludwig, for her guidance and expertise. Her insightful feedback and constructive criticism have been instrumental in shaping my approaches and writing. 

I am very grateful to all of you. Your collective support has made this work possible. Thank you.

\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Table of Contents
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\baselinestretch}{1.3}
\small\normalsize

\setcounter{tocdepth}{1}
\tableofcontents

\renewcommand{\baselinestretch}{1}
\small\normalsize

\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% List of Figures
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\baselinestretch}{1.3}
\small\normalsize

\addcontentsline{toc}{chapter}{List of Figures}
\listoffigures

\renewcommand{\baselinestretch}{1}
\small\normalsize

\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% List of tables
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\baselinestretch}{1.3}
\small\normalsize

\addcontentsline{toc}{chapter}{List of Tables}
\listoftables

\renewcommand{\baselinestretch}{1}
\small\normalsize

\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% List of abbreviations
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% can be removed
\addcontentsline{toc}{chapter}{List of Abbreviations}
\chapter*{List of Abbreviations\markboth{LIST OF ABBREVIATIONS}{LIST OF ABBREVIATIONS}}
\begin{tabbing}
\textbf{FACTOTUM}\hspace{1cm}\=Schrott\kill
\textbf{CO2}\>Carbon Dioxide\\
\textbf{DB}\>Decision Biasing\\
\textbf{DHI}\>Diffuse Horizontal Irradiance \\
\textbf{DNI}\>Direct Normal Irradiance \\
\textbf{DDPG}\>Deep Deterministic Policy Gradient \\
\textbf{GHI}\>Global Horizontal Irradiance \\
\textbf{i.i.d.}\>Independent and Identically Distributed \\
\textbf{ILR}\>Imitation Learning Rate \\
\textbf{KPI}\>Key Performance Indicator \\
\textbf{kWh}\>Kilowatt-hour \\
\textbf{MARLISA}\> Multi-Agent Reinforcement Learning with Iterative \\ 
\>Sequential Action Selection \\
\textbf{MDP}\>Markov Decision Process \\
\textbf{NSRDB}\>National Solar Radiation Database \\
\textbf{NY}\> New York \\
\textbf{NYISO}\>New York Independent System Operator \\
\textbf{PCC}\>Pearson Correlation Coefficient \\
\textbf{PRB}\>Prioritized Replay Buffer \\
\textbf{PV}\> Photovoltaic \\
\textbf{RBC}\>Rule-Based Controller \\
\textbf{RL}\>Reinforcement Learning \\
\textbf{SAC}\>Soft Actor-Critic \\
\textbf{TD error}\> Temporal Difference error \\
\textbf{VS}\> Value Shaping \\
\end{tabbing}

\cleardoublepage


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Der Haupttext, ab hier mit arabischer Numerierung
%%% Mit \input{dateiname} werden die Datei `dateiname' eingebundent
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pagenumbering{arabic}
\setcounter{page}{1}

%% Introduction
\input{intro}
\cleardoublepage

%% 
\input{Background}
\cleardoublepage

%% 
\input{MM}
\cleardoublepage

%% 
\input{social_agents}
\cleardoublepage

%%
\input{discussion}
\cleardoublepage

%%
\input{conclusion}
\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Appendix
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{appendix}
\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Bibliographie
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\addcontentsline{toc}{chapter}{Bibliography}

\bibliographystyle{alpha}
\bibliography{thesislit}
%% Obige Anweisung legt fest, dass BibTeX-Datei `mylit.bib' verwendet
%% wird. Hier koennen mehrere Dateinamen mit Kommata getrennt aufgelistet
%% werden.

\cleardoublepage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Erklaerung
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\thispagestyle{empty}
\section*{Selbst\"andigkeitserkl\"arung}

Hiermit versichere ich, dass ich die vorliegende Masterarbeit 
selbst\"andig und nur mit den angegebenen Hilfsmitteln angefertigt habe und dass alle Stellen, die dem Wortlaut oder dem 
Sinne nach anderen Werken entnommen sind, durch Angaben von Quellen als 
Entlehnung kenntlich gemacht worden sind. 
Diese Masterarbeit wurde in gleicher oder \"ahnlicher Form in keinem anderen 
Studiengang als Pr\"ufungsleistung vorgelegt. 

\vskip 3cm

Ort, Datum	\hfill Unterschrift \hfill 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Ende
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}

