%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% LaTeX-Rahmen fuer das Erstellen von Masterarbeiten
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% allgemeine Einstellungen
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[twoside,12pt,a4paper]{report}
%\usepackage{reportpage}
\usepackage{epsf}
\usepackage{graphics, graphicx}
\usepackage{latexsym}
\usepackage[margin=10pt,font=small,labelfont=bf]{caption}
\usepackage[utf8]{inputenc}
\usepackage[toc,page]{appendix}


% Own packages
\usepackage[colorinlistoftodos]{todonotes}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{amssymb}
\usepackage{tabularx}
\usepackage{url}
\usepackage{amsmath}
\usepackage[permil]{overpic}
\usepackage{multirow}
\usepackage{enumitem}
\usepackage{fancyhdr}
\usepackage{booktabs} 

\newcolumntype{Y}{>{\centering\arraybackslash}X}
\newcommand\numberthis{\addtocounter{equation}{1}\tag{\theequation}}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}

\hyphenation{thatshouldnot}


\textwidth 14cm
\textheight 22cm
\topmargin 0.0cm
\evensidemargin 1cm
\oddsidemargin 1cm
%\footskip 2cm
\parskip0.5explus0.1exminus0.1ex

% Kann von Student auch nach pers\"onlichem Geschmack ver\"andert werden.
\pagestyle{headings}
\fancypagestyle{plain}{%
\fancyhf{} % clear all header and footer fields
\fancyhead{} % clear all header fields
\fancyfoot{} % clear all footer fields
\fancyhead[RO]{\thepage}
\fancyhead[LE]{\thepage}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
}

\sloppy

\begin{document}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% hier steht die neue Titelseite 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
 
\begin{titlepage}
 \begin{center}
  {\LARGE Eberhard Karls Universit\"at T\"ubingen}\\
  {\large Mathematisch-Naturwissenschaftliche Fakult\"at \\
Wilhelm-Schickard-Institut f\"ur Informatik\\[4cm]}
  {\huge Master Thesis Computer Science\\[2cm]}
  {\Large\bf  Incorporating Social Learning into Multi-Agent Reinforcement Learning
to \\Lower Carbon Emissions in Energy Systems\\[1.5cm]}
 {\large Kristina Lietz}\\[0.5cm]
01.12.2023\\[3.5cm]
{\small\bf Reviewers}\\[0.5cm]
  \parbox{7cm}{\begin{center}{\large Dr. Nicole Ludwig}\\
   (Machine Learning in Sustainable Energy Systems)\\
  {\footnotesize Exzellenzcluster "Maschinelles Lernen"\\
	Universit\"at T\"ubingen}\end{center}}\hfill\parbox{7cm}{\begin{center}
  {\large Prof. Setareh Maghsudi}\\
  (Decision Making)\\
  {\footnotesize Wilhelm-Schickard-Institut f\"ur Informatik\\
	Universit\"at T\"ubingen}\end{center}
 }
  \end{center}
\end{titlepage}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Titelr"uckseite: Bibliographische Angaben
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\thispagestyle{empty}
\vspace*{\fill}
\begin{minipage}{11.2cm}
\textbf{Lietz, Kristina:}\\
\emph{Incorporating Social Learning into Multi-Agent Reinforcement Learning
to Lower Carbon Emissions in Energy Systems}\\ Master Thesis Computer Science\\
Eberhard Karls Universit\"at T\"ubingen\\
Thesis period: 01.06.2023~--~01.12.2023
\end{minipage}
\newpage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pagenumbering{roman}
\setcounter{page}{1}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Seite I: Zusammenfassug, Danksagung
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\section*{Abstract}
Reducing the consumption of fossil fuels is crucial for mitigating climate change, as it reduces greenhouse gas emissions. At the same time, renewable energy creates more uncertainty in the energy supply, challenging the traditional approach of consuming available energy immediately.
This thesis explores integrating social learning into multi-agent reinforcement learning to minimize fossil fuel consumption in building energy management. By equipping each building with a battery, the study employs agents to learn optimal charging and discharging strategies. 
We use the CityLearn framework, modified to suit our requirements and define four KPIs for evaluation. As a baseline, we train a non-social Soft Actor-Critic (SAC) agent, which we compare to four social learning methods. These methods include imitation learning for policy mimicry, SAC-DemoPol, which biases the policy toward demonstrator actions, SAC-DemoQ, which increases the Q-values of demonstrator actions, and the MARLISA algorithm for collaborative fossil energy saving. Results indicate that the SAC-DemoQ agents, trained with a pre-trained demonstrator, outperform the SAC baseline by approximately 1.5 \% in fossil energy savings. Using novel building data, the social agents save about 1 \% more fossil energy. The other social methods achieved minimal or no improvement. We suggest future evaluation using more diverse datasets and employing methods such as value shaping, clustering for optimal demonstrator selection, and fine-tuning the imitation learning rate to enhance the efficacy of the proposed strategy in reducing fossil fuel consumption in buildings.

\newpage
\section*{Zusammenfassung}
Die Verringerung des Verbrauchs fossiler Brennstoffe und die damit verbundene Reduzierung der Treibhausgasemissionen sind für die Eindämmung des Klimawandels von entscheidender Bedeutung. Gleichzeitig schaffen erneuerbare Energien mehr Unsicherheit in der Energieversorgung, was den traditionellen Ansatz des sofortigen Verbrauchs der verfügbaren Energie infrage stellt.
In dieser Arbeit wird die Integration von sozialem Lernen in Multi-Agenten Reinforcement Learning untersucht, um den Verbrauch fossiler Brennstoffe im Energiemanagement von Gebäuden zu minimieren. Es werden Agenten entwickelt, welche optimale Lade- und Entladestrategien der Batterien von Gebäuden erlernen. 
Wir verwenden das CityLearn-Framework, das wir an unsere Anforderungen anpassen, und definieren vier KPIs für die Performanzbewertung. Als Ausgangsbasis trainieren wir einen nicht-sozialen Soft Actor-Critic (SAC)-Agenten, den wir mit vier sozialen Lernmethoden vergleichen. Zu diesen Methoden gehören das Nachahmungslernen für die Nachahmung der Policy eines Demonstrators, SAC-DemoPol, wobei die Policy in Richtung der Demonstrantenaktionen gelenkt wird, SAC-DemoQ, wobei die Q-Werte der Demonstrantenaktionen erhöht werden, und der MARLISA-Algorithmus für kollaboratives fossiles Energiesparen. Die Ergebnisse zeigen, dass die SAC-DemoQ-Agenten, die mit einem vortrainierten Demonstrator trainiert wurden, die unsozialen SAC-Agenten bei der Einsparung fossiler Energie um etwa 1,5 \% übertreffen. Bei Verwendung neuer Gebäudedaten sparen die sozialen Agenten etwa 1 \% mehr fossile Energie. Die anderen sozialen Ansätze zeigen keine oder nur minimale Verbesserung. Wir schlagen vor, zukünftige Evaluierungen mit vielfältigeren Datensätzen und unter Verwendung von Methoden wie Value Shaping, Clustering für die optimale Auswahl von Demonstratoren und Feinabstimmung der Imitationslernrate durchzuführen, um die Wirksamkeit der entwickelten Strategie bei der Reduzierung des Verbrauchs fossiler Brennstoffe in Gebäuden zu verbessern.



\newpage
\section*{Acknowledgements}
I sincerely thank all those who have supported me in my studies and during this work.

First, I would like to express my deepest gratitude to my closest family: My sister Annika, my parents Heike, Rüdiger, Andrea, and my grandma Ellen. Your emotional support and encouragement help guide me through all the difficult times and inspire me to persevere. Your belief in me and my abilities was a source of motivation and perseverance.

I am also immensely grateful to my friends who have supported me, especially in the last few months: Jule, Elli, Basti, Steffen, Fabio and Flop. Your support, camaraderie and understanding have been crucial in this work. The proofreading from some of you also helped me a lot. The moments we have shared and the moral support you have given me have been invaluable and have given me balance and a sense of belonging.

Special thanks to my supervisor, Dr. Nicole Ludwig, for her guidance, patience, and expertise. Her insightful feedback and constructive criticism have been instrumental in shaping my research and writing. 

I am deeply grateful to all of you. Your collective support has made this work possible. Thank you.

\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Table of Contents
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\baselinestretch}{1.3}
\small\normalsize

\setcounter{tocdepth}{1}
\tableofcontents

\renewcommand{\baselinestretch}{1}
\small\normalsize

\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% List of Figures
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\baselinestretch}{1.3}
\small\normalsize

\addcontentsline{toc}{chapter}{List of Figures}
\listoffigures

\renewcommand{\baselinestretch}{1}
\small\normalsize

\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% List of tables
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\baselinestretch}{1.3}
\small\normalsize

\addcontentsline{toc}{chapter}{List of Tables}
\listoftables

\renewcommand{\baselinestretch}{1}
\small\normalsize

\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% List of abbreviations
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% can be removed
\addcontentsline{toc}{chapter}{List of Abbreviations}
\chapter*{List of Abbreviations\markboth{LIST OF ABBREVIATIONS}{LIST OF ABBREVIATIONS}}
\begin{tabbing}
\textbf{FACTOTUM}\hspace{1cm}\=Schrott\kill
\textbf{CO2}\>Carbon Dioxide\\
\textbf{DB}\>Decision Biasing\\
\textbf{DHI}\>Diffuse Horizontal Irradiance \\
\textbf{DNI}\>Direct Normal Irradiation \\
\textbf{DDPG}\>Deep Deterministic Policy Gradient \\
\textbf{GHI}\>Global Horizontal Irradiance \\
\textbf{i.i.d.}\>independent and identically distributed \\
\textbf{ILR}\>Imitation Learning Rate \\
\textbf{KPI}\>Key performance indicator \\
\textbf{kWh}\>Kilowatt-hour \\
\textbf{L2 loss}\>Mean Squared Error Loss \\
\textbf{MARLISA}\> Multi-Agent Reinforcement Learning with Iterative \\ 
\>Sequential Action Selection \\
\textbf{MDP}\>Markov decision process \\
\textbf{NSRDB}\>National Solar Radiation Database \\
\textbf{NY}\> New York \\
\textbf{NYISO}\>New York Independent System Operator \\
\textbf{PCC}\>Pearson Correlation Coefficient \\
\textbf{PRB}\>Prioritized Replay Buffer \\
\textbf{PV}\> Photovoltaic \\
\textbf{RBC}\>Rule-Based Controller \\
\textbf{RL}\>Reinforcement learning \\
\textbf{SAC}\>Soft actor-critic \\
\textbf{TD error}\> Temporal Difference error \\
\end{tabbing}

\cleardoublepage


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Der Haupttext, ab hier mit arabischer Numerierung
%%% Mit \input{dateiname} werden die Datei `dateiname' eingebundent
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pagenumbering{arabic}
\setcounter{page}{1}

%% Introduction
\input{intro}
\cleardoublepage

%% 
\input{Background}
\cleardoublepage

%% 
\input{MM}
\cleardoublepage

%% 
\input{social_agents}
\cleardoublepage

%%
\input{discussion}
\cleardoublepage

%%
\input{conclusion}
\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Appendix
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{appendix}
\cleardoublepage

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Bibliographie
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\addcontentsline{toc}{chapter}{Bibliography}

\bibliographystyle{alpha}
\bibliography{thesislit}
%% Obige Anweisung legt fest, dass BibTeX-Datei `mylit.bib' verwendet
%% wird. Hier koennen mehrere Dateinamen mit Kommata getrennt aufgelistet
%% werden.

\cleardoublepage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Erklaerung
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\thispagestyle{empty}
\section*{Selbst\"andigkeitserkl\"arung}

Hiermit versichere ich, dass ich die vorliegende Masterarbeit 
selbst\"andig und nur mit den angegebenen Hilfsmitteln angefertigt habe und dass alle Stellen, die dem Wortlaut oder dem 
Sinne nach anderen Werken entnommen sind, durch Angaben von Quellen als 
Entlehnung kenntlich gemacht worden sind. 
Diese Masterarbeit wurde in gleicher oder \"ahnlicher Form in keinem anderen 
Studiengang als Pr\"ufungsleistung vorgelegt. 

\vskip 3cm

Ort, Datum	\hfill Unterschrift \hfill 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Ende
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{document}

